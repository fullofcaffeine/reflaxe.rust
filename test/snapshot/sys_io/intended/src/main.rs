// Generated by reflaxe.rust (POC)

use std::cell::RefCell;
use std::rc::Rc;

type HxRef<T> = Rc<RefCell<T>>;

mod sys;
mod sys__file_system;
mod sys_io__file;
use crate::sys::Sys;
use crate::sys__file_system::FileSystem;
use crate::sys_io__file::File;

fn main() {
    println!("{}", String::from("--- args ---"));
    println!("{}", Sys::args().len() as i32);
    println!("{}", String::from("--- file content ---"));
    let mut path: String = String::from("tmp_sys_io.txt");
    File::saveContent(path.clone(), String::from("hello").clone());
    println!("{}", File::getContent(path.clone()));
    println!("{}", FileSystem::exists(path.clone()));
    FileSystem::deleteFile(path.clone());
    println!("{}", FileSystem::exists(path.clone()));
    println!("{}", String::from("--- file bytes ---"));
    let mut bin: String = String::from("tmp_sys_io.bin");
    let mut bytes: HxRef<hxrt::bytes::Bytes> = Rc::new(RefCell::new(
        hxrt::bytes::Bytes::of_string(String::from("ABC").as_str()),
    ));
    File::saveBytes(bin.clone(), bytes);
    let mut bytes2: HxRef<hxrt::bytes::Bytes> = File::getBytes(bin.clone());
    println!("{}", bytes2.borrow().to_string());
    FileSystem::deleteFile(bin.clone());
    println!("{}", String::from("--- dir listing ---"));
    let mut dir: String = String::from("tmp_sys_dir");
    FileSystem::createDirectory(dir.clone());
    File::saveContent(
        format!("{}{}", dir, String::from("/a.txt")).clone(),
        String::from("a").clone(),
    );
    File::saveContent(
        format!("{}{}", dir, String::from("/b.txt")).clone(),
        String::from("b").clone(),
    );
    let mut entries: Vec<String> = FileSystem::readDirectory(dir.clone());
    let mut foundA: bool = false;
    let mut foundB: bool = false;
    let mut foundDot: bool = false;
    let mut foundDotDot: bool = false;
    {
        let mut _g: i32 = 0;
        while _g < entries.len() as i32 {
            let mut e: String = entries[_g as usize].clone();
            {
                _g = _g + 1;
                _g
            };
            if e == String::from("a.txt") {
                foundA = true
            };
            if e == String::from("b.txt") {
                foundB = true
            };
            if e == String::from(".") {
                foundDot = true
            };
            if e == String::from("..") {
                foundDotDot = true
            };
        }
    };
    println!("{}", foundA);
    println!("{}", foundB);
    println!("{}", foundDot);
    println!("{}", foundDotDot);
    FileSystem::deleteFile(format!("{}{}", dir, String::from("/a.txt")).clone());
    FileSystem::deleteFile(format!("{}{}", dir, String::from("/b.txt")).clone());
    FileSystem::deleteDirectory(dir.clone());
    println!("{}", FileSystem::exists(dir.clone()));
}
