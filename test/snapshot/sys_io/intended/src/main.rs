// Generated by reflaxe.rust (POC)

#![allow(dead_code)]

type HxRef<T> = std::rc::Rc<std::cell::RefCell<T>>;

mod haxe_ds_enum_value_map;
mod haxe_ds_int_map;
mod haxe_ds_object_map;
mod haxe_ds_string_map;
mod haxe_int64_int64;
mod haxe_int64_int64_impl_;
mod haxe_io_bytes_buffer;
mod haxe_io_encoding;
mod haxe_io_eof;
mod haxe_io_fp_helper;
mod haxe_io_input;
mod haxe_io_output;
mod sys;
mod sys_file_system;
mod sys_io_file;
mod sys_io_stderr;
mod sys_io_stdin;
mod sys_io_stdout;

fn main() {
    println!("{}", hxrt::dynamic::from(String::from("--- args ---")));
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys::Sys::args().len() as i32)
    );
    println!("{}", hxrt::dynamic::from(String::from("--- env ---")));
    crate::sys::Sys::put_env(String::from("HX_TEST_ENV"), Some(String::from("ok")));
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys::Sys::get_env(String::from("HX_TEST_ENV")).clone())
    );
    let env: crate::HxRef<crate::haxe_ds_string_map::StringMap<String>> =
        crate::sys::Sys::environment();
    println!(
        "{}",
        hxrt::dynamic::from(crate::haxe_ds_string_map::StringMap::exists(
            &env,
            String::from("HX_TEST_ENV")
        ))
    );
    println!(
        "{}",
        hxrt::dynamic::from(
            crate::haxe_ds_string_map::StringMap::get(&env, String::from("HX_TEST_ENV")).clone()
        )
    );
    crate::sys::Sys::put_env(String::from("HX_TEST_ENV"), None);
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys::Sys::get_env(String::from("HX_TEST_ENV")).clone())
    );
    println!("{}", hxrt::dynamic::from(String::from("--- stdout ---")));
    crate::sys::Sys::stdout().write_string(String::from("hello stdout\n"), None);
    crate::sys::Sys::stdout().flush();
    println!(
        "{}",
        hxrt::dynamic::from(String::from("--- file content ---"))
    );
    let path: String = String::from("tmp_sys_io.txt");
    crate::sys_io_file::File::save_content(path.clone(), String::from("hello"));
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys_io_file::File::get_content(path.clone()).clone())
    );
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys_file_system::FileSystem::exists(path.clone()))
    );
    crate::sys_file_system::FileSystem::delete_file(path.clone());
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys_file_system::FileSystem::exists(path.clone()))
    );
    println!(
        "{}",
        hxrt::dynamic::from(String::from("--- file bytes ---"))
    );
    let bin: String = String::from("tmp_sys_io.bin");
    let bytes: crate::HxRef<hxrt::bytes::Bytes> = std::rc::Rc::new(std::cell::RefCell::new(
        hxrt::bytes::Bytes::of_string(String::from("ABC").as_str()),
    ));
    crate::sys_io_file::File::save_bytes(bin.clone(), bytes.clone());
    let bytes2: crate::HxRef<hxrt::bytes::Bytes> = crate::sys_io_file::File::get_bytes(bin.clone());
    println!(
        "{}",
        hxrt::dynamic::from(bytes2.borrow().to_string().clone())
    );
    crate::sys_file_system::FileSystem::delete_file(bin.clone());
    println!(
        "{}",
        hxrt::dynamic::from(String::from("--- dir listing ---"))
    );
    let dir: String = String::from("tmp_sys_dir");
    crate::sys_file_system::FileSystem::create_directory(dir.clone());
    crate::sys_io_file::File::save_content(format!("{}{}", &dir, "/a.txt"), String::from("a"));
    crate::sys_io_file::File::save_content(format!("{}{}", &dir, "/b.txt"), String::from("b"));
    let entries: hxrt::array::Array<String> =
        crate::sys_file_system::FileSystem::read_directory(dir.clone());
    let mut found_a: bool = false;
    let mut found_b: bool = false;
    let mut found_dot: bool = false;
    let mut found_dot_dot: bool = false;
    {
        let mut _g: i32 = 0;
        while _g < entries.len() as i32 {
            let e: String = entries.get_unchecked(_g as usize);
            {
                _g = _g + 1;
                _g
            };
            if e == String::from("a.txt") {
                found_a = true;
            }
            if e == String::from("b.txt") {
                found_b = true;
            }
            if e == String::from(".") {
                found_dot = true;
            }
            if e == String::from("..") {
                found_dot_dot = true;
            }
        }
    }
    println!("{}", hxrt::dynamic::from(found_a));
    println!("{}", hxrt::dynamic::from(found_b));
    println!("{}", hxrt::dynamic::from(found_dot));
    println!("{}", hxrt::dynamic::from(found_dot_dot));
    crate::sys_file_system::FileSystem::delete_file(format!("{}{}", &dir, "/a.txt"));
    crate::sys_file_system::FileSystem::delete_file(format!("{}{}", &dir, "/b.txt"));
    crate::sys_file_system::FileSystem::delete_directory(dir.clone());
    println!(
        "{}",
        hxrt::dynamic::from(crate::sys_file_system::FileSystem::exists(dir.clone()))
    );
}
