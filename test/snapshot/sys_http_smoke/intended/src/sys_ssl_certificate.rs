// Generated by reflaxe.rust (POC)

pub const __HX_TYPE_ID: u32 = 0x2d898137u32;

#[derive(Debug)]

pub struct Certificate {
    pub handle: crate::HxRef<hxrt::ssl::Certificate>,
    pub common_name: Option<String>,
    pub alt_names: hxrt::array::Array<String>,
    pub not_before: crate::HxRef<crate::date::Date>,
    pub not_after: crate::HxRef<crate::date::Date>,
}

impl Certificate {
    pub fn new(
        handle: crate::HxRef<hxrt::ssl::Certificate>,
    ) -> crate::HxRef<crate::sys_ssl_certificate::Certificate> {
        let self_: crate::HxRef<crate::sys_ssl_certificate::Certificate> =
            crate::HxRc::new(crate::HxRefCell::new(Certificate {
                handle: handle,
                common_name: None,
                alt_names: hxrt::array::Array::<String>::new(),
                not_before: crate::date::Date::new(0, 0, 0, 0, 0, 0),
                not_after: crate::date::Date::new(0, 0, 0, 0, 0, 0),
            }));
        return self_;
    }

    pub fn _hxrt_handle(
        self_: &crate::HxRefCell<Certificate>,
    ) -> crate::HxRef<hxrt::ssl::Certificate> {
        return self_.borrow().handle.clone();
    }

    pub fn subject(self_: &crate::HxRefCell<Certificate>, field: String) -> Option<String> {
        return self_
            .borrow()
            .handle
            .clone()
            .borrow()
            .subject_field(field.as_str());
    }

    pub fn issuer(self_: &crate::HxRefCell<Certificate>, field: String) -> Option<String> {
        return self_
            .borrow()
            .handle
            .clone()
            .borrow()
            .issuer_field(field.as_str());
    }

    pub fn next(
        self_: &crate::HxRefCell<Certificate>,
    ) -> Option<crate::HxRef<crate::sys_ssl_certificate::Certificate>> {
        return {
            match hxrt::ssl::cert_next(&self_.borrow().handle.clone()) {
                None => None,
                Some(h) => Some(crate::sys_ssl_certificate::Certificate::from_handle(h)),
            }
        };
    }

    pub fn add(self_: &crate::HxRefCell<Certificate>, pem: String) {
        hxrt::ssl::cert_add_pem(&self_.borrow().handle.clone(), pem.as_str());
    }

    pub fn add_der(self_: &crate::HxRefCell<Certificate>, der: crate::HxRef<hxrt::bytes::Bytes>) {
        hxrt::ssl::cert_add_der(&self_.borrow().handle.clone(), der.borrow().as_slice());
    }

    pub fn get_common_name(self_: &crate::HxRefCell<Certificate>) -> Option<String> {
        return self_.borrow().handle.clone().borrow().common_name();
    }

    pub fn get_alt_names(self_: &crate::HxRefCell<Certificate>) -> hxrt::array::Array<String> {
        return hxrt::array::Array::<String>::from_vec(
            self_.borrow().handle.clone().borrow().alt_names(),
        );
    }

    pub fn get_not_before(
        self_: &crate::HxRefCell<Certificate>,
    ) -> crate::HxRef<crate::date::Date> {
        let ms: f64 = self_.borrow().handle.clone().borrow().not_before_ms() as f64;
        return crate::date::Date::from_time(ms);
    }

    pub fn get_not_after(self_: &crate::HxRefCell<Certificate>) -> crate::HxRef<crate::date::Date> {
        let ms: f64 = self_.borrow().handle.clone().borrow().not_after_ms() as f64;
        return crate::date::Date::from_time(ms);
    }

    pub(crate) fn from_handle(
        handle: crate::HxRef<hxrt::ssl::Certificate>,
    ) -> crate::HxRef<crate::sys_ssl_certificate::Certificate> {
        return crate::sys_ssl_certificate::Certificate::new(handle.clone());
    }

    pub fn load_file(file: String) -> crate::HxRef<crate::sys_ssl_certificate::Certificate> {
        let h: crate::HxRef<hxrt::ssl::Certificate> = hxrt::ssl::cert_load_file(file.as_str());
        return crate::sys_ssl_certificate::Certificate::new(h.clone());
    }

    pub fn load_path(path: String) -> crate::HxRef<crate::sys_ssl_certificate::Certificate> {
        let h: crate::HxRef<hxrt::ssl::Certificate> = hxrt::ssl::cert_load_path(path.as_str());
        return crate::sys_ssl_certificate::Certificate::new(h.clone());
    }

    pub fn from_string(str: String) -> crate::HxRef<crate::sys_ssl_certificate::Certificate> {
        let h: crate::HxRef<hxrt::ssl::Certificate> = hxrt::ssl::cert_from_string(str.as_str());
        return crate::sys_ssl_certificate::Certificate::new(h.clone());
    }

    pub fn load_defaults() -> crate::HxRef<crate::sys_ssl_certificate::Certificate> {
        let h: crate::HxRef<hxrt::ssl::Certificate> = hxrt::ssl::cert_load_defaults();
        return crate::sys_ssl_certificate::Certificate::new(h.clone());
    }
}
