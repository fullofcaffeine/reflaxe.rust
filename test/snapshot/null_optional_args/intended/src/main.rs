// Generated by reflaxe.rust (POC)

#![allow(dead_code)]

type HxRc<T> = hxrt::cell::HxRc<T>;
type HxRefCell<T> = hxrt::cell::HxCell<T>;
type HxRef<T> = hxrt::cell::HxRef<T>;

mod haxe_call_stack_call_stack_impl_;
mod haxe_ds_enum_value_map;
mod haxe_ds_int_map;
mod haxe_ds_list;
mod haxe_ds_object_map;
mod haxe_ds_string_map;
mod haxe_exception;
mod haxe_int64_int64;
mod haxe_int64_int64_impl_;
mod haxe_io_bytes_buffer;
mod haxe_io_encoding;
mod haxe_io_eof;
mod haxe_io_fp_helper;
mod haxe_io_input;
mod haxe_io_output;
mod haxe_stack_item;
mod sys;
mod sys_io_stderr;
mod sys_io_stdin;
mod sys_io_stdout;

fn count_if(
    it: hxrt::array::Array<i32>,
    pred: Option<crate::HxRc<dyn Fn(i32) -> bool + Send + Sync>>,
) -> i32 {
    let mut n: i32 = 0;
    if pred.is_none() {
        let mut _g: i32 = 0;
        while _g < it.len() as i32 {
            let _unused: i32 = it.get_unchecked(_g as usize);
            {
                _g = _g + 1;
                _g
            };
            {
                let __tmp = n;
                n = n + 1;
                __tmp
            };
        }
    } else {
        let mut _g_2: i32 = 0;
        while _g_2 < it.len() as i32 {
            let x: i32 = it.get_unchecked(_g_2 as usize);
            {
                _g_2 = _g_2 + 1;
                _g_2
            };
            if pred.as_ref().unwrap()(x) {
                {
                    let __tmp = n;
                    n = n + 1;
                    __tmp
                };
            }
        }
    }
    return n;
}

fn ret_null(ok: bool) -> Option<i32> {
    if ok {
        return Some(1);
    }
    return None;
}

fn tail_null(ok: bool) -> Option<i32> {
    return if ok { Some(2) } else { None };
}

fn main() {
    let a: hxrt::array::Array<i32> = hxrt::array::Array::<i32>::from_vec(vec![1, 2, 3, 4]);
    let t0: i32 = count_if(a.clone(), None);
    let t1: i32 = count_if(
        a.clone(),
        Some(crate::HxRc::new(move |x: i32| {
            return x == 2 || x == 4;
        })),
    );
    let t2: i32 = {
        let pred: Option<crate::HxRc<dyn Fn(i32) -> bool + Send + Sync>> = None;
        let mut n: i32 = 0;
        if pred.is_none() {
            let mut _g_current: i32;
            let _g_array: hxrt::array::Array<i32>;
            _g_current = 0;
            _g_array = a.clone();
            while _g_current < _g_array.len() as i32 {
                let _unused: i32 = _g_array.get_unchecked(
                    ({
                        let __tmp = _g_current;
                        _g_current = _g_current + 1;
                        __tmp
                    }) as usize,
                );
                {
                    let __tmp = n;
                    n = n + 1;
                    __tmp
                };
            }
        } else {
            let mut _g_current_2: i32;
            let _g_array_2: hxrt::array::Array<i32>;
            _g_current_2 = 0;
            _g_array_2 = a.clone();
            while _g_current_2 < _g_array_2.len() as i32 {
                let x: i32 = _g_array_2.get_unchecked(
                    ({
                        let __tmp = _g_current_2;
                        _g_current_2 = _g_current_2 + 1;
                        __tmp
                    }) as usize,
                );
                if pred.as_ref().unwrap()(x) {
                    {
                        let __tmp = n;
                        n = n + 1;
                        __tmp
                    };
                }
            }
        }
        n
    };
    let t3: i32 = {
        let mut n_2: i32 = 0;
        {
            let mut _g_current_3: i32;
            let _g_array_3: hxrt::array::Array<i32>;
            _g_current_3 = 0;
            _g_array_3 = a.clone();
            while _g_current_3 < _g_array_3.len() as i32 {
                let x_2: i32 = _g_array_3.get_unchecked(
                    ({
                        let __tmp = _g_current_3;
                        _g_current_3 = _g_current_3 + 1;
                        __tmp
                    }) as usize,
                );
                if x_2 > 2 {
                    {
                        let __tmp = n_2;
                        n_2 = n_2 + 1;
                        __tmp
                    };
                }
            }
        }
        n_2
    };
    let x_3: Option<i32>;
    {
        let __tmp = 3;
        x_3 = Some(__tmp);
        __tmp
    };
    let r0: Option<i32> = ret_null(true);
    let r1: Option<i32> = ret_null(false);
    let r2: Option<i32> = tail_null(true);
    let r3: Option<i32> = tail_null(false);
    crate::sys::Sys::println(hxrt::dynamic::from(t0));
    crate::sys::Sys::println(hxrt::dynamic::from(t1));
    crate::sys::Sys::println(hxrt::dynamic::from(t2));
    crate::sys::Sys::println(hxrt::dynamic::from(t3));
    crate::sys::Sys::println(hxrt::dynamic::from(x_3.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(x_3.is_some()));
    crate::sys::Sys::println(hxrt::dynamic::from(r0.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(r1.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(r2.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(r3.is_none()));
}
