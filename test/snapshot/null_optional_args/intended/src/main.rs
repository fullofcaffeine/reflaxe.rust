// Generated by reflaxe.rust (POC)

#![allow(dead_code)]

type HxRef<T> = std::rc::Rc<std::cell::RefCell<T>>;

mod haxe_ds_list;
mod sys;

fn count_if(it: Vec<i32>, pred: Option<std::rc::Rc<dyn Fn(i32) -> bool>>) -> i32 {
    let mut n: i32 = 0;
    if pred.is_none() {
        let mut _g: i32 = 0;
        while _g < it.len() as i32 {
            let _unused: i32 = it[_g as usize];
            {
                _g = _g + 1;
                _g
            };
            {
                let __tmp = n;
                n = n + 1;
                __tmp
            };
        }
    } else {
        let mut _g_2: i32 = 0;
        while _g_2 < it.len() as i32 {
            let x: i32 = it[_g_2 as usize];
            {
                _g_2 = _g_2 + 1;
                _g_2
            };
            if pred.as_ref().unwrap()(x) {
                {
                    let __tmp = n;
                    n = n + 1;
                    __tmp
                };
            }
        }
    }
    return n;
}

fn ret_null(ok: bool) -> Option<i32> {
    if ok {
        return Some(1);
    }
    return None;
}

fn tail_null(ok: bool) -> Option<i32> {
    return if ok { Some(2) } else { None };
}

fn main() {
    let a: Vec<i32> = vec![1, 2, 3, 4];
    let t0: i32 = count_if(a.clone(), None);
    let t1: i32 = count_if(
        a.clone(),
        Some(std::rc::Rc::new(move |x: i32| {
            return x == 2 || x == 4;
        })),
    );
    let t2: i32 = {
        let pred: Option<std::rc::Rc<dyn Fn(i32) -> bool>> = None;
        let mut n: i32 = 0;
        if pred.is_none() {
            let mut _g_current: i32;
            let _g_array: Vec<i32>;
            _g_current = 0;
            _g_array = a.clone();
            while _g_current < _g_array.len() as i32 {
                let _unused: i32 = _g_array[({
                    let __tmp = _g_current;
                    _g_current = _g_current + 1;
                    __tmp
                }) as usize];
                {
                    let __tmp = n;
                    n = n + 1;
                    __tmp
                };
            }
        } else {
            let mut _g_current_2: i32;
            let _g_array_2: Vec<i32>;
            _g_current_2 = 0;
            _g_array_2 = a.clone();
            while _g_current_2 < _g_array_2.len() as i32 {
                let x: i32 = _g_array_2[({
                    let __tmp = _g_current_2;
                    _g_current_2 = _g_current_2 + 1;
                    __tmp
                }) as usize];
                if pred.as_ref().unwrap()(x) {
                    {
                        let __tmp = n;
                        n = n + 1;
                        __tmp
                    };
                }
            }
        }
        n
    };
    let t3: i32 = {
        let mut n_2: i32 = 0;
        {
            let mut _g_current_3: i32;
            let _g_array_3: Vec<i32>;
            _g_current_3 = 0;
            _g_array_3 = a.clone();
            while _g_current_3 < _g_array_3.len() as i32 {
                let x_2: i32 = _g_array_3[({
                    let __tmp = _g_current_3;
                    _g_current_3 = _g_current_3 + 1;
                    __tmp
                }) as usize];
                if x_2 > 2 {
                    {
                        let __tmp = n_2;
                        n_2 = n_2 + 1;
                        __tmp
                    };
                }
            }
        }
        n_2
    };
    let x_3: Option<i32>;
    {
        let __tmp = 3;
        x_3 = Some(__tmp);
        __tmp
    };
    let r0: Option<i32> = ret_null(true);
    let r1: Option<i32> = ret_null(false);
    let r2: Option<i32> = tail_null(true);
    let r3: Option<i32> = tail_null(false);
    crate::sys::Sys::println(hxrt::dynamic::from(t0));
    crate::sys::Sys::println(hxrt::dynamic::from(t1));
    crate::sys::Sys::println(hxrt::dynamic::from(t2));
    crate::sys::Sys::println(hxrt::dynamic::from(t3));
    crate::sys::Sys::println(hxrt::dynamic::from(x_3.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(x_3.is_some()));
    crate::sys::Sys::println(hxrt::dynamic::from(r0.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(r1.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(r2.is_none()));
    crate::sys::Sys::println(hxrt::dynamic::from(r3.is_none()));
}
