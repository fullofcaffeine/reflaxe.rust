// Generated by reflaxe.rust (POC)

pub const __HX_TYPE_ID: u32 = 0xfa1b3a4du32;

#[derive(Debug)]

pub struct Sha256 {}

impl Sha256 {
    pub fn new() -> crate::HxRef<crate::haxe_crypto_sha256::Sha256> {
        let self_: crate::HxRef<crate::haxe_crypto_sha256::Sha256> = crate::HxRef::new(Sha256 {});
        return self_;
    }

    fn do_encode(
        _self_: &crate::HxRefCell<Sha256>,
        m: hxrt::array::Array<i32>,
        l: i32,
    ) -> hxrt::array::Array<i32> {
        let k: hxrt::array::Array<i32> = hxrt::array::Array::<i32>::from_vec(vec![
            1116352408,
            1899447441,
            -1245643825,
            -373957723,
            961987163,
            1508970993,
            -1841331548,
            -1424204075,
            -670586216,
            310598401,
            607225278,
            1426881987,
            1925078388,
            -2132889090,
            -1680079193,
            -1046744716,
            -459576895,
            -272742522,
            264347078,
            604807628,
            770255983,
            1249150122,
            1555081692,
            1996064986,
            -1740746414,
            -1473132947,
            -1341970488,
            -1084653625,
            -958395405,
            -710438585,
            113926993,
            338241895,
            666307205,
            773529912,
            1294757372,
            1396182291,
            1695183700,
            1986661051,
            -2117940946,
            -1838011259,
            -1564481375,
            -1474664885,
            -1035236496,
            -949202525,
            -778901479,
            -694614492,
            -200395387,
            275423344,
            430227734,
            506948616,
            659060556,
            883997877,
            958139571,
            1322822218,
            1537002063,
            1747873779,
            1955562222,
            2024104815,
            -2067236844,
            -1933114872,
            -1866530822,
            -1538233109,
            -1090935817,
            -965641998,
        ]);
        let hash: hxrt::array::Array<i32> = hxrt::array::Array::<i32>::from_vec(vec![
            1779033703,
            -1150833019,
            1013904242,
            -1521486534,
            1359893119,
            -1694144372,
            528734635,
            1541459225,
        ]);
        let w: hxrt::array::Array<i32> = hxrt::array::Array::<i32>::new();
        {
            let __tmp = 0;
            w.set_haxe(64 as usize, __tmp, move || 0);
            __tmp
        };
        let mut a: i32;
        let mut b: i32;
        let mut c: i32;
        let mut d: i32;
        let mut e: i32;
        let mut f: i32;
        let mut g: i32;
        let mut h: i32;
        let mut t1: i32;
        let mut t2: i32;
        let index: i32 = l >> 5;
        {
            let __hx_arr = m.clone();
            let __hx_idx = index as usize;
            let __rhs = 128 << 24 - l % 32;
            let __tmp = __hx_arr.get_unchecked(__hx_idx) | __rhs;
            __hx_arr.set(__hx_idx, __tmp);
            __tmp
        };
        {
            let __tmp = l;
            m.set_haxe(((l + 64 >> 9 << 4) + 15) as usize, __tmp, move || 0);
            __tmp
        };
        let mut i: i32 = 0;
        while i < (m.len() as i32) {
            a = hash.get_unchecked(0 as usize);
            b = hash.get_unchecked(1 as usize);
            c = hash.get_unchecked(2 as usize);
            d = hash.get_unchecked(3 as usize);
            e = hash.get_unchecked(4 as usize);
            f = hash.get_unchecked(5 as usize);
            g = hash.get_unchecked(6 as usize);
            h = hash.get_unchecked(7 as usize);
            {
                let mut _g: i32 = 0;
                while _g < 64 {
                    let j: i32 = {
                        let __tmp = _g;
                        _g = _g + 1;
                        __tmp
                    };
                    if j < 16 {
                        {
                            let __tmp = m.get_unchecked((j + i) as usize);
                            w.set_haxe(j as usize, __tmp, move || 0);
                            __tmp
                        };
                    } else {
                        {
                            let __tmp = {
                                let x: i32 = {
                                    let x_2: i32 = {
                                        let x_3: i32 = {
                                            let x_4: i32 = w.get_unchecked((j - 2) as usize);
                                            ((x_4 as u32 >> 17 as u32) as i32 | x_4 << 15)
                                                ^ ((x_4 as u32 >> 19 as u32) as i32 | x_4 << 13)
                                                ^ (x_4 as u32 >> 10 as u32) as i32
                                        };
                                        let y: i32 = w.get_unchecked((j - 7) as usize);
                                        let lsw: i32 = (x_3 & 65535) + (y & 65535);
                                        let msw: i32 = (x_3 >> 16) + (y >> 16) + (lsw >> 16);
                                        msw << 16 | lsw & 65535
                                    };
                                    let y_2: i32 = {
                                        let x_5: i32 = w.get_unchecked((j - 15) as usize);
                                        ((x_5 as u32 >> 7 as u32) as i32 | x_5 << 25)
                                            ^ ((x_5 as u32 >> 18 as u32) as i32 | x_5 << 14)
                                            ^ (x_5 as u32 >> 3 as u32) as i32
                                    };
                                    let lsw_2: i32 = (x_2 & 65535) + (y_2 & 65535);
                                    let msw_2: i32 = (x_2 >> 16) + (y_2 >> 16) + (lsw_2 >> 16);
                                    msw_2 << 16 | lsw_2 & 65535
                                };
                                let y_3: i32 = w.get_unchecked((j - 16) as usize);
                                let lsw_3: i32 = (x & 65535) + (y_3 & 65535);
                                let msw_3: i32 = (x >> 16) + (y_3 >> 16) + (lsw_3 >> 16);
                                msw_3 << 16 | lsw_3 & 65535
                            };
                            w.set_haxe(j as usize, __tmp, move || 0);
                            __tmp
                        };
                    }
                    t1 = {
                        let x_6: i32 = {
                            let x_7: i32 = {
                                let x_8: i32 = {
                                    let y_4: i32 = ((e as u32 >> 6 as u32) as i32 | e << 26)
                                        ^ ((e as u32 >> 11 as u32) as i32 | e << 21)
                                        ^ ((e as u32 >> 25 as u32) as i32 | e << 7);
                                    let lsw_4: i32 = (h & 65535) + (y_4 & 65535);
                                    let msw_4: i32 = (h >> 16) + (y_4 >> 16) + (lsw_4 >> 16);
                                    msw_4 << 16 | lsw_4 & 65535
                                };
                                let y_5: i32 = e & f ^ !e & g;
                                let lsw_5: i32 = (x_8 & 65535) + (y_5 & 65535);
                                let msw_5: i32 = (x_8 >> 16) + (y_5 >> 16) + (lsw_5 >> 16);
                                msw_5 << 16 | lsw_5 & 65535
                            };
                            let y_6: i32 = k.get_unchecked(j as usize);
                            let lsw_6: i32 = (x_7 & 65535) + (y_6 & 65535);
                            let msw_6: i32 = (x_7 >> 16) + (y_6 >> 16) + (lsw_6 >> 16);
                            msw_6 << 16 | lsw_6 & 65535
                        };
                        let y_7: i32 = w.get_unchecked(j as usize);
                        let lsw_7: i32 = (x_6 & 65535) + (y_7 & 65535);
                        let msw_7: i32 = (x_6 >> 16) + (y_7 >> 16) + (lsw_7 >> 16);
                        msw_7 << 16 | lsw_7 & 65535
                    };
                    t2 = {
                        let x_9: i32 = ((a as u32 >> 2 as u32) as i32 | a << 30)
                            ^ ((a as u32 >> 13 as u32) as i32 | a << 19)
                            ^ ((a as u32 >> 22 as u32) as i32 | a << 10);
                        let y_8: i32 = a & b ^ a & c ^ b & c;
                        let lsw_8: i32 = (x_9 & 65535) + (y_8 & 65535);
                        let msw_8: i32 = (x_9 >> 16) + (y_8 >> 16) + (lsw_8 >> 16);
                        msw_8 << 16 | lsw_8 & 65535
                    };
                    h = g;
                    g = f;
                    f = e;
                    e = {
                        let lsw_9: i32 = (d & 65535) + (t1 & 65535);
                        let msw_9: i32 = (d >> 16) + (t1 >> 16) + (lsw_9 >> 16);
                        msw_9 << 16 | lsw_9 & 65535
                    };
                    d = c;
                    c = b;
                    b = a;
                    a = {
                        let lsw_10: i32 = (t1 & 65535) + (t2 & 65535);
                        let msw_10: i32 = (t1 >> 16) + (t2 >> 16) + (lsw_10 >> 16);
                        msw_10 << 16 | lsw_10 & 65535
                    };
                }
            }
            {
                let __tmp = {
                    let y_9: i32 = hash.get_unchecked(0 as usize);
                    let lsw_11: i32 = (a & 65535) + (y_9 & 65535);
                    let msw_11: i32 = (a >> 16) + (y_9 >> 16) + (lsw_11 >> 16);
                    msw_11 << 16 | lsw_11 & 65535
                };
                hash.set_haxe(0 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_10: i32 = hash.get_unchecked(1 as usize);
                    let lsw_12: i32 = (b & 65535) + (y_10 & 65535);
                    let msw_12: i32 = (b >> 16) + (y_10 >> 16) + (lsw_12 >> 16);
                    msw_12 << 16 | lsw_12 & 65535
                };
                hash.set_haxe(1 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_11: i32 = hash.get_unchecked(2 as usize);
                    let lsw_13: i32 = (c & 65535) + (y_11 & 65535);
                    let msw_13: i32 = (c >> 16) + (y_11 >> 16) + (lsw_13 >> 16);
                    msw_13 << 16 | lsw_13 & 65535
                };
                hash.set_haxe(2 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_12: i32 = hash.get_unchecked(3 as usize);
                    let lsw_14: i32 = (d & 65535) + (y_12 & 65535);
                    let msw_14: i32 = (d >> 16) + (y_12 >> 16) + (lsw_14 >> 16);
                    msw_14 << 16 | lsw_14 & 65535
                };
                hash.set_haxe(3 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_13: i32 = hash.get_unchecked(4 as usize);
                    let lsw_15: i32 = (e & 65535) + (y_13 & 65535);
                    let msw_15: i32 = (e >> 16) + (y_13 >> 16) + (lsw_15 >> 16);
                    msw_15 << 16 | lsw_15 & 65535
                };
                hash.set_haxe(4 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_14: i32 = hash.get_unchecked(5 as usize);
                    let lsw_16: i32 = (f & 65535) + (y_14 & 65535);
                    let msw_16: i32 = (f >> 16) + (y_14 >> 16) + (lsw_16 >> 16);
                    msw_16 << 16 | lsw_16 & 65535
                };
                hash.set_haxe(5 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_15: i32 = hash.get_unchecked(6 as usize);
                    let lsw_17: i32 = (g & 65535) + (y_15 & 65535);
                    let msw_17: i32 = (g >> 16) + (y_15 >> 16) + (lsw_17 >> 16);
                    msw_17 << 16 | lsw_17 & 65535
                };
                hash.set_haxe(6 as usize, __tmp, move || 0);
                __tmp
            };
            {
                let __tmp = {
                    let y_16: i32 = hash.get_unchecked(7 as usize);
                    let lsw_18: i32 = (h & 65535) + (y_16 & 65535);
                    let msw_18: i32 = (h >> 16) + (y_16 >> 16) + (lsw_18 >> 16);
                    msw_18 << 16 | lsw_18 & 65535
                };
                hash.set_haxe(7 as usize, __tmp, move || 0);
                __tmp
            };
            {
                i = i + 16;
                i
            };
        }
        return hash;
    }

    fn hex(_self_: &crate::HxRefCell<Sha256>, a: hxrt::array::Array<i32>) -> String {
        let mut str: String = String::from("");
        {
            let mut _g: i32 = 0;
            while _g < (a.len() as i32) {
                let num: i32 = a.get_unchecked(_g as usize);
                {
                    _g = _g + 1;
                    _g
                };
                {
                    let __tmp = crate::string_tools::StringTools::hex(num, Some(8));
                    str = format!("{}{}", str, __tmp);
                }
            }
        }
        return hxrt::string::to_lower_case(str.as_str());
    }

    pub fn encode(s: String) -> String {
        let sh: crate::HxRef<crate::haxe_crypto_sha256::Sha256> =
            crate::haxe_crypto_sha256::Sha256::new();
        let h: hxrt::array::Array<i32> = crate::haxe_crypto_sha256::Sha256::do_encode(
            &*sh,
            crate::haxe_crypto_sha256::Sha256::str2blks(s.clone()),
            hxrt::string::len(s.as_str()) * 8,
        );
        return crate::haxe_crypto_sha256::Sha256::hex(&*sh, h.clone());
    }

    fn str2blks(s: String) -> hxrt::array::Array<i32> {
        let s_2: crate::HxRef<hxrt::bytes::Bytes> =
            crate::HxRef::new(hxrt::bytes::Bytes::of_string(s.as_str()));
        let nblk: i32 = (s_2.borrow().length() + 8 >> 6) + 1;
        let blks: hxrt::array::Array<i32> = hxrt::array::Array::<i32>::new();
        {
            let mut _g: i32 = 0;
            let _g1: i32 = nblk * 16;
            while _g < _g1 {
                let i: i32 = {
                    let __tmp = _g;
                    _g = _g + 1;
                    __tmp
                };
                {
                    let __tmp = 0;
                    blks.set_haxe(i as usize, __tmp, move || 0);
                    __tmp
                };
            }
        }
        {
            let mut _g_2: i32 = 0;
            let _g1_2: i32 = s_2.borrow().length();
            while _g_2 < _g1_2 {
                let i_2: i32 = {
                    let __tmp = _g_2;
                    _g_2 = _g_2 + 1;
                    __tmp
                };
                let p: i32 = i_2 >> 2;
                {
                    let __hx_arr = blks.clone();
                    let __hx_idx = p as usize;
                    let __rhs = s_2.borrow().get(i_2) << 24 - ((i_2 & 3) << 3);
                    let __tmp = __hx_arr.get_unchecked(__hx_idx) | __rhs;
                    __hx_arr.set(__hx_idx, __tmp);
                    __tmp
                };
            }
        }
        let i_3: i32 = s_2.borrow().length();
        let p_2: i32 = i_3 >> 2;
        {
            let __hx_arr = blks.clone();
            let __hx_idx = p_2 as usize;
            let __rhs = 128 << 24 - ((i_3 & 3) << 3);
            let __tmp = __hx_arr.get_unchecked(__hx_idx) | __rhs;
            __hx_arr.set(__hx_idx, __tmp);
            __tmp
        };
        {
            let __tmp = s_2.borrow().length() * 8;
            blks.set_haxe((nblk * 16 - 1) as usize, __tmp, move || 0);
            __tmp
        };
        return blks;
    }
}
